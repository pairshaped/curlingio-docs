<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Passwordless Auth, Done Right | Curling IO</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://curling.io/img/curlingio-logo-small.png"><meta data-rh="true" name="twitter:image" content="https://curling.io/img/curlingio-logo-small.png"><meta data-rh="true" property="og:url" content="https://curling.io/blog/passwordless-auth-done-right"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Passwordless Auth, Done Right | Curling IO"><meta data-rh="true" name="description" content="Curling IO has been passwordless since Version 2. No passwords to remember, no passwords to steal, no password reset flows. You enter your email, we send you a short-lived login code, and you&#x27;re in. It&#x27;s been working well for over a decade, and for Version 3 we&#x27;re keeping the same approach while fixing some rough edges and adding multi-email support."><meta data-rh="true" property="og:description" content="Curling IO has been passwordless since Version 2. No passwords to remember, no passwords to steal, no password reset flows. You enter your email, we send you a short-lived login code, and you&#x27;re in. It&#x27;s been working well for over a decade, and for Version 3 we&#x27;re keeping the same approach while fixing some rough edges and adding multi-email support."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2026-02-20T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="foundation,authentication,gleam,security"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://curling.io/blog/passwordless-auth-done-right"><link data-rh="true" rel="alternate" href="https://curling.io/blog/passwordless-auth-done-right" hreflang="en"><link data-rh="true" rel="alternate" href="https://curling.io/blog/passwordless-auth-done-right" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://56JJO2SJ1B-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://curling.io/blog/passwordless-auth-done-right","mainEntityOfPage":"https://curling.io/blog/passwordless-auth-done-right","url":"https://curling.io/blog/passwordless-auth-done-right","headline":"Passwordless Auth, Done Right","name":"Passwordless Auth, Done Right","description":"Curling IO has been passwordless since Version 2. No passwords to remember, no passwords to steal, no password reset flows. You enter your email, we send you a short-lived login code, and you're in. It's been working well for over a decade, and for Version 3 we're keeping the same approach while fixing some rough edges and adding multi-email support.","datePublished":"2026-02-20T00:00:00.000Z","author":{"@type":"Person","name":"Dave Rapin","description":"Founder @ Curling IO","image":"https://avatars.githubusercontent.com/u/1202?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://curling.io/blog","name":"Curling IO Dev Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Curling IO Dev Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Curling IO Dev Blog Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Curling IO Dev Blog JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-1016652572"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","AW-1016652572",{})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Curling IO" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.61e4d3f7.css">
<script src="/assets/js/runtime~main.0fee1e5e.js" defer="defer"></script>
<script src="/assets/js/main.c5d89108.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/curlingio-logo-small.png" alt="Curling IO Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/curlingio-logo-small.png" alt="Curling IO Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Curling IO</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/getting-started/curling-club-managers">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://clubs.curling.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Find your Club<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/passwordless-auth-done-right">Passwordless Auth, Done Right</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bilingual-by-design">Bilingual by Design</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/the-next-version-of-curling-io">The Next Version of Curling IO</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Passwordless Auth, Done Right</h1><div class="container_mt6G margin-vert--md"><time datetime="2026-02-20T00:00:00.000Z">February 20, 2026</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/1202?v=4" alt="Dave Rapin"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Dave Rapin</span></div><small class="authorTitle_nd0D" title="Founder @ Curling IO">Founder @ Curling IO</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Curling IO has been passwordless since Version 2. No passwords to remember, no passwords to steal, no password reset flows. You enter your email, we send you a short-lived login code, and you&#x27;re in. It&#x27;s been working well for over a decade, and for Version 3 we&#x27;re keeping the same approach while fixing some rough edges and adding multi-email support.</p>
<p>But first, let&#x27;s talk about why we made this <u><em>controversial decision</em></u> in the first place.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-not-passwords">Why Not Passwords?<a href="#why-not-passwords" class="hash-link" aria-label="Direct link to Why Not Passwords?" title="Direct link to Why Not Passwords?">​</a></h2>
<p>The conventional wisdom is that passwords are the &quot;real&quot; way to authenticate and login links are a shortcut. We think it&#x27;s the opposite. Passwords are the shortcut, and they create more problems than they solve. We&#x27;re not alone. Slack, Notion, Medium, and Substack all use passwordless login links as their primary authentication method.</p>
<p><strong>Passwords get reused.</strong> Study after study shows that most people reuse the same password across multiple sites. When any one of those sites gets breached, attackers try those credentials everywhere else. This isn&#x27;t a theoretical risk. It happens constantly, and it&#x27;s the number one way accounts get compromised. As an application developer, you can&#x27;t control what your users do on other sites, but you inherit the risk.</p>
<p><strong>Passwords get phished.</strong> A convincing fake login page can harvest credentials at scale. Login links are inherently resistant to phishing because there&#x27;s no credential to hand over. The code is short-lived and tied to a specific email address.</p>
<p><strong>Passwords require just as much email verification.</strong> Here&#x27;s the thing people overlook: even with passwords, you still need to verify the user&#x27;s email. Otherwise anyone can create an account with someone else&#x27;s email address. So you end up building the same email verification flow that login links use, plus the password management on top of it. You&#x27;re not avoiding email. You&#x27;re adding a password layer on top of it.</p>
<p><strong>The industry agrees.</strong> Look at what banks and other high-security sites do now: even after you enter your email and password, they send you a one-time code via text or email. Password alone isn&#x27;t enough anymore, so they&#x27;ve added the exact same verification step we use. Some have a &quot;remember this device for 2 weeks&quot; checkbox, but in practice it rarely works. You log in an hour later after your session times out and they&#x27;re sending you another code. It&#x27;s not just frustrating. It reveals that the password itself has become a meaningless step. The one-time code is doing the actual authentication. The password is just theater you have to sit through before you get to the part that matters. We skip it entirely.</p>
<p><strong>Passwords add surface area.</strong> With passwords, you need: secure hashing (bcrypt/argon2), a &quot;forgot password&quot; flow (which is itself a login link), password strength validation, brute force protection on the login form, and secure storage. Login links need rate limiting and token management too, but the overall surface area is smaller. There&#x27;s no credential to store long-term, no password policy to enforce, and no &quot;forgot password&quot; flow to build since the login flow <em>is</em> the recovery flow.</p>
<p><strong>&quot;But what about password managers?&quot;</strong> Password managers are great. They solve the reuse and phishing problems for users who use them. But most users don&#x27;t. And for the curling club use case, where members log in a handful of times per season, asking them to set up and maintain a password manager is unrealistic. Login links meet users where they are.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-login-links-are-secure">How Login Links Are Secure<a href="#how-login-links-are-secure" class="hash-link" aria-label="Direct link to How Login Links Are Secure" title="Direct link to How Login Links Are Secure">​</a></h2>
<p>A login link is a short-lived code sent to your email. The security model rests on a simple assumption: if you can read email sent to that address, you control that address. This is the same assumption that password reset flows rely on, but we cut out the middleman.</p>
<p>Here&#x27;s what makes the implementation secure:</p>
<p><strong>High-entropy tokens.</strong> Each login code is drawn from a high-entropy space, but it doesn&#x27;t need to be astronomical because of the next two points. The token generator uses Gleam&#x27;s binary pattern matching to map cryptographically random bytes to an unambiguous alphabet:</p>
<div class="language-gleam codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gleam codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pub fn generate_token() -&gt; String {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  let alphabet_size = string.length(token_alphabet)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  crypto.strong_random_bytes(token_length)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  |&gt; pick_chars(alphabet_size, &quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">fn pick_chars(bytes: BitArray, alphabet_size: Int, acc: String) -&gt; String {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  case bytes {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;&lt;b, rest:bits&gt;&gt; -&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      let idx = b % alphabet_size</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      let ch = string.slice(token_alphabet, idx, 1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      pick_chars(rest, alphabet_size, acc &lt;&gt; ch)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    _ -&gt; acc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Aggressive rate limiting.</strong> Authentication attempts are tightly rate limited across multiple layered time windows. Brute-forcing the token space is completely impractical. Each window is checked in sequence using Gleam&#x27;s <code>use</code> syntax. If any window is exceeded, it short-circuits and returns the retry-after time without checking the rest:</p>
<div class="language-gleam codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gleam codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pub fn check_verification_attempt(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  limiter: RateLimiter,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  email: String,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  now: Int,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">) -&gt; Result(Nil, Int) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  let key = key_prefix &lt;&gt; string.lowercase(email)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  use _ &lt;- result.try(check(limiter, key, attempts_per_minute, 60, now))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  use _ &lt;- result.try(check(limiter, key, attempts_per_15_minutes, 900, now))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  use _ &lt;- result.try(check(limiter, key, attempts_per_hour, 3600, now))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  check(limiter, key, attempts_per_day, 86_400, now)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Short-lived.</strong> Each code expires quickly. After verification, the token hash is cleared from the database. There&#x27;s no window for replay attacks.</p>
<p><strong>Constant-time comparison.</strong> We look up the email row first, then compare the submitted token hash against the stored hash using Gleam&#x27;s <code>crypto.secure_compare</code>. This takes the same amount of time regardless of where the first mismatch occurs, preventing timing attacks that could leak information about partial matches. If the current token doesn&#x27;t match, we check the previous token, not to log them in, but to return a specific error message guiding the user to check for a more recent email:</p>
<div class="language-gleam codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gleam codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">let hashes_match =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  crypto.secure_compare(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bit_array.from_string(submitted_hash),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bit_array.from_string(stored_hash),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">case hashes_match {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  True -&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    case row.token_expires_at {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      Some(expires_at) if expires_at &gt; now -&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        complete_verification(conn, row, now)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      _ -&gt; Error(ExpiredToken)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  False -&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    case row.previous_token_hash {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      Some(prev_hash) -&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        let prev_match =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          crypto.secure_compare(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            bit_array.from_string(submitted_hash),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            bit_array.from_string(prev_hash),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case prev_match {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          True -&gt; Error(SupersededToken)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          False -&gt; Error(InvalidToken)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      None -&gt; Error(InvalidToken)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Every branch returns a specific error variant, and the compiler ensures we handle all of them. No forgotten edge cases. The previous token never grants access. It only exists to give a better error message than a generic &quot;invalid token.&quot;</p>
<p><strong>No credential storage.</strong> There are no passwords in our database. In a breach scenario, attackers get token hashes that are short-lived. Compare that to a password database where every hash is a target for offline cracking.</p>
<p>It&#x27;s also worth noting that the main vulnerability of login links is a compromised email account. But if someone&#x27;s email is compromised, they have much bigger problems than their Curling IO profile. And a password-based system is equally vulnerable in that scenario. The attacker just clicks &quot;forgot password&quot; and they&#x27;re in.</p>
<p>The bottom line: login links are not a weaker form of authentication. For our use case, they&#x27;re stronger. They eliminate entire categories of attacks (credential stuffing, phishing, password spraying) while being simpler for both users and developers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="takeaways-from-version-2">Takeaways from Version 2<a href="#takeaways-from-version-2" class="hash-link" aria-label="Direct link to Takeaways from Version 2" title="Direct link to Takeaways from Version 2">​</a></h2>
<p>Version 2&#x27;s login link flow is straightforward: enter your email, get a code, enter the code, you&#x27;re in. It works. But after a decade and hundreds of thousands of users, a few pain points emerged.</p>
<p><strong>One email, one identity.</strong> In Version 2, your email <em>is</em> your identity. Log in with a different email, you get a different account. This has been a real source of confusion. A club manager registers with their work email, then tries to log in from their phone with their personal email, and they&#x27;re looking at an empty account. We&#x27;d get support requests about &quot;missing registrations&quot; that were really just the same person with two accounts.</p>
<p><strong>Unhelpful error messages.</strong> This one came up a lot. A curler would request a login link, wait a minute or two, not see the email, and request another one. The first email was usually just delayed. Many email clients only check for new mail every 5 to 15 minutes. When the first email finally arrived and they clicked it, they&#x27;d get a generic &quot;invalid token&quot; error because the second request had replaced the first. They&#x27;d wonder if they mistyped something, try again, get confused, and contact support.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="version-3-adds-multiple-email-addresses">Version 3 Adds Multiple Email Addresses<a href="#version-3-adds-multiple-email-addresses" class="hash-link" aria-label="Direct link to Version 3 Adds Multiple Email Addresses" title="Direct link to Version 3 Adds Multiple Email Addresses">​</a></h2>
<p>This is the big addition. Users can now associate multiple verified email addresses with their account:</p>
<p><strong>Add an email.</strong> From the account page, enter a new email address. We send a verification code using the same mechanism as login.</p>
<p><strong>Verify it.</strong> Enter the code. The email is now linked to your account and marked as verified. Unverified emails can&#x27;t be used for anything.</p>
<p><strong>Set it as primary.</strong> Any verified email can be promoted to primary. Your primary email is what shows up across the platform, in admin dashboards, on team rosters, in email communications. Changing your primary is a single click.</p>
<p><strong>Remove it.</strong> Non-primary emails can be removed. You can&#x27;t remove your primary (switch to a different one first) and you can&#x27;t remove your last verified email (you need at least one to log in).</p>
<p><strong>Log in with any of them.</strong> This is the key benefit. Once you&#x27;ve added and verified multiple emails, logging in with <em>any</em> of them resolves to the same account, the same registrations, the same history. No more duplicate accounts because you used a different email.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works-under-the-hood">How It Works Under the Hood<a href="#how-it-works-under-the-hood" class="hash-link" aria-label="Direct link to How It Works Under the Hood" title="Direct link to How It Works Under the Hood">​</a></h3>
<p>Each email row tracks a few key fields:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">email               -- globally unique, one owner max</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">user_id             -- nullable; not set until verified for first-time logins</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">token_hash          -- pending verification token</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">previous_token_hash -- the token that was replaced (for superseded detection)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">verified_at         -- null until verified</span><br></span></code></pre></div></div>
<p>This single structure handles both login verification and email ownership.</p>
<p>The design means multi-email support was almost free. The same verification flow used for login handles email verification for logged-in users. The only difference is that the user is already set when you&#x27;re adding an email to your existing account.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="superseded-token-detection">Superseded Token Detection<a href="#superseded-token-detection" class="hash-link" aria-label="Direct link to Superseded Token Detection" title="Direct link to Superseded Token Detection">​</a></h2>
<p>Remember the delayed email problem from Version 2? A curler requests a link, doesn&#x27;t see it right away, requests another, and then clicks the first one when it finally arrives. Version 3 handles this gracefully.</p>
<p>When a new login link is requested, we don&#x27;t just overwrite the old token. We move the current <code>token_hash</code> to <code>previous_token_hash</code> first. If someone then tries the old token, we can tell the difference:</p>
<div class="language-gleam codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gleam codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pub type AuthError {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  InvalidToken      // not found or already used</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  SupersededToken   // replaced by a newer token</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ExpiredToken      // past expiry</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  UserDisabled      // account disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  DatabaseError(sqlight.Error)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>A <code>SupersededToken</code> gets a specific message: &quot;This code has been replaced. Check for a more recent email or request a new link.&quot; Instead of leaving users confused, we point them in the right direction.</p>
<p>This is a pattern we use throughout Version 3. Gleam&#x27;s union types let us model every possible error state explicitly, and the compiler ensures we handle all of them. No forgotten edge cases, no generic catch-all error messages.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="oauth-google-and-facebook">OAuth (Google and Facebook)<a href="#oauth-google-and-facebook" class="hash-link" aria-label="Direct link to OAuth (Google and Facebook)" title="Direct link to OAuth (Google and Facebook)">​</a></h2>
<p>Login links aren&#x27;t the only way in. Google and Facebook login work alongside them for users who prefer one-click SSO.</p>
<p>The OAuth flow uses a central auth subdomain (<code>auth.curling.io</code>) to handle callbacks, since both providers require a fixed redirect URI. After the provider verifies the user&#x27;s identity, we look up the email in the same table used for login links. If the email exists with a user, log them in. If not, create the user and a verified email row (OAuth emails are pre-verified by the provider).</p>
<p>The same user resolution logic, regardless of how you authenticate.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-note-on-rolling-your-own-auth">A Note on Rolling Your Own Auth<a href="#a-note-on-rolling-your-own-auth" class="hash-link" aria-label="Direct link to A Note on Rolling Your Own Auth" title="Direct link to A Note on Rolling Your Own Auth">​</a></h2>
<p>Writing your own authentication is generally a bad idea. Battle-tested libraries like <a href="https://github.com/heartcombo/devise" target="_blank">Devise</a> (Ruby), <a href="https://next-auth.js.org" target="_blank">NextAuth</a> (JavaScript), and <a href="https://django-allauth.readthedocs.io" target="_blank">django-allauth</a> (Python) exist for good reason. They&#x27;ve been hardened over years of real-world use and security audits. If you&#x27;re building on a stack that has a mature auth library, use it.</p>
<p>We couldn&#x27;t find an existing Gleam auth library that was the right fit for our specific needs, but we didn&#x27;t design in a vacuum. We studied Devise&#x27;s modules extensively (Lockable, Timeoutable, Trackable, Confirmable) and used them as a checklist for what a production auth system needs to handle. Every security decision we made, from constant-time comparison to layered rate limiting to email enumeration prevention, was informed by what these libraries have learned the hard way over the past decade.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What&#x27;s Next<a href="#whats-next" class="hash-link" aria-label="Direct link to What&#x27;s Next" title="Direct link to What&#x27;s Next">​</a></h2>
<p>Authentication is foundational, but the real value of multi-email support shows up when it connects to everything else: registrations, team management, admin permissions, payment history. As we build those features, having clean user resolution across multiple emails will simplify a lot of workflows that were painful in Version 2.</p>
<p>We&#x27;re also considering optional two-factor authentication for club administrators, via authenticator apps or SMS, for organizations that want to force an extra layer of security on accounts with administrative access.</p>
<hr>
<p><em>This is Part 3 of the Curling IO Foundation series. Next up: background jobs on the BEAM, with no Redis, no separate worker, and no additional infrastructure.</em></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/foundation">foundation</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/authentication">authentication</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/gleam">gleam</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/security">security</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/bilingual-by-design"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Bilingual by Design</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-not-passwords" class="table-of-contents__link toc-highlight">Why Not Passwords?</a></li><li><a href="#how-login-links-are-secure" class="table-of-contents__link toc-highlight">How Login Links Are Secure</a></li><li><a href="#takeaways-from-version-2" class="table-of-contents__link toc-highlight">Takeaways from Version 2</a></li><li><a href="#version-3-adds-multiple-email-addresses" class="table-of-contents__link toc-highlight">Version 3 Adds Multiple Email Addresses</a><ul><li><a href="#how-it-works-under-the-hood" class="table-of-contents__link toc-highlight">How It Works Under the Hood</a></li></ul></li><li><a href="#superseded-token-detection" class="table-of-contents__link toc-highlight">Superseded Token Detection</a></li><li><a href="#oauth-google-and-facebook" class="table-of-contents__link toc-highlight">OAuth (Google and Facebook)</a></li><li><a href="#a-note-on-rolling-your-own-auth" class="table-of-contents__link toc-highlight">A Note on Rolling Your Own Auth</a></li><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What&#39;s Next</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/curling-club-managers">For Clubs</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/for-curlers/how-do-i-login">For Curlers</a></li><li class="footer__item"><a href="https://www.youtube.com/@curlingio" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tutorial Videos<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/curlingio" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://curling.ca" target="_blank" rel="noopener noreferrer" class="footer__link-item">Curling Canada<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/terms">Terms</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy">Privacy</a></li><li class="footer__item"><a href="https://curlingschedules.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Curling Schedules<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Curling IO</div></div></div></footer></div>
</body>
</html>